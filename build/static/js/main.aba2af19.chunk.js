(this["webpackJsonpblockstack-contacts-manager"]=this["webpackJsonpblockstack-contacts-manager"]||[]).push([[0],{278:function(t,e,n){t.exports=n(575)},303:function(t,e){},305:function(t,e){},320:function(t,e){},322:function(t,e){},425:function(t,e){},427:function(t,e){},434:function(t,e){},445:function(t,e){},502:function(t,e){},573:function(t,e,n){},575:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(270),s=n.n(r),c=n(579),o=n(27),l=n(28),u=n(50),d=n(49),m=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var t=this.props.handleSignIn;return i.a.createElement("div",{className:"panel-landing",id:"section-1"},i.a.createElement("h1",{className:"landing-heading"},"KeyWatch"),i.a.createElement("p",{className:"lead"},i.a.createElement("button",{className:"btn btn-primary btn-lg",id:"signin-button",onClick:t.bind(this)},"Sign In with Blockstack")))}}]),n}(a.Component),h=n(10),p=n(43),g=n(163),b=n(164);function f(){var t=Object(g.a)(["\n  border-radius: 3px;\n  border: 1px solid #ddd;\n  box-sizing: border-box;\n  padding-left: 10px;\n  display: inline-block;\n  outline: none;\n  width:100%;\n  margin:5px 0px;\n"]);return f=function(){return t},t}function v(){var t=Object(g.a)(["\n  text-align: left;\n  display: block;\n  width: 300px;\n  margin: 10px;\n"]);return v=function(){return t},t}var E=b.a.div(v()),k=b.a.input(f()),N=n(577),w=n(580),C=n(273),y=n.n(C),S=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).fetchContact=function(t){a.setState({loading:!0}),p.Contact.get(t).then((function(t){t?a.setState({contact:t,identifier:t.identifier,lastName:t.lastName||"",blockstackID:t.blockstackID||"",email:t.email||"",loading:!1}):a.setState({loading:!1,errors:{notFound:"Error fetching contact data."}})})).catch((function(t){a.setState({loading:!1,errors:{notFound:"Error fetching contact data."}})}))},a.validateInput=function(){var t={};return""===a.state.lastName&&(t.lastName="Please enter a website."),t},a.checkExisting=function(t){return p.Contact.get(t).then((function(t){return!!t})).catch((function(){return!1}))},a.handleSave=function(){if(!a.state.saving){var t=a.validateInput();if(Object.entries(t).length)return void a.setState({errors:t});if(a.setState({saving:!0}),a.state.new){var e=a.createNewContact();return a.checkExisting(e.constructIdentifier()).then((function(t){if(!t)return e.save().then((function(){a.props.history.push("/")}));a.setState({errors:{contactExists:' "'.concat(a.state.lastName,'" already exists, cannot overwrite.')},saving:!1})}))}return a.saveContact()}},a.createNewContact=function(){var t={lastName:a.state.lastName,blockstackID:a.state.blockstackID,email:a.state.email};return new p.Contact(t)},a.saveContact=function(){if(a.state.contact){var t=a.state.contact;t.lastName=a.state.lastName,t.blockstackID=a.state.blockstackID,t.email=a.state.email,a.setState({contact:t}),t.save().then((function(){a.props.history.push("/")}))}},a.handleDelete=function(){a.state.deleting||(a.setState({deleting:!0}),a.state.contact&&a.state.contact.delete().then((function(){a.props.history.push("/")})))},a.state={new:t.new,contact:p.Contact,identifier:"",lastName:"",blockstackID:"",email:"",errors:{},saving:!1,loading:!1,deleting:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){if(!this.props.new){var t=y.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).id;t?this.fetchContact(t):this.setState({errors:{notFound:"The website does not exist."}})}}},{key:"onChange",value:function(t,e){t.preventDefault(),t.target.value.length<50&&this.setState(Object(h.a)({},e,t.target.value))}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"panel-landing",id:"section-1"},i.a.createElement("h1",{className:"landing-heading"},this.state.new?"New Credentials":"View/Edit Password"),this.state.errors.notFound&&this.state.errors.notFound,this.state.loading&&"Loading...",!this.state.loading&&!this.state.errors.notFound&&i.a.createElement("div",{className:"panel"},i.a.createElement(E,null,"Website ",i.a.createElement("br",null),i.a.createElement("span",{className:"input-error"},this.state.errors.lastName),i.a.createElement(k,{type:"text",value:this.state.lastName,onChange:function(e){return t.onChange(e,"lastName")}})),i.a.createElement(E,null,"Username/Email ",i.a.createElement("br",null),i.a.createElement(k,{type:"text",value:this.state.blockstackID,onChange:function(e){return t.onChange(e,"blockstackID")}})),i.a.createElement(E,null,"Password ",i.a.createElement("br",null),i.a.createElement(k,{type:"text",value:this.state.email,onChange:function(e){return t.onChange(e,"email")}})),i.a.createElement("br",null),this.state.errors.contactExists&&i.a.createElement("span",{className:"input-error"},this.state.errors.contactExists,i.a.createElement("br",null),i.a.createElement("br",null)),i.a.createElement("div",{className:"button-group"},i.a.createElement("button",{className:"btn btn-primary btn-lg",id:"save-button",disabled:this.state.saving,onClick:this.handleSave},this.state.saving?"Almost Done...":"Save"),i.a.createElement("button",{className:"btn btn-danger btn-lg",id:"delete-button",disabled:this.state.deleting,onClick:this.handleDelete},this.state.deleting?"Deleting...":"Delete")),i.a.createElement(N.a,{className:"btn btn-default btn-lg",to:"/"},"Back")))}}]),n}(a.Component),O=Object(w.a)(S),x=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).state={contacts:[],loaded:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;p.Contact.list((function(e){var n=t.state.contacts;return n.push(e),t.setState({contacts:n,loaded:!0}),!0}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"panel-landing",id:"section-1"},i.a.createElement("h1",{className:"landing-heading"},"KeyWatch"),i.a.createElement("div",{className:"panel"},i.a.createElement("div",{className:"contact-list"},0===this.state.contacts.length&&this.state.loaded&&i.a.createElement("p",null,"Nothing here yet"),this.state.contacts.map((function(t,e){return i.a.createElement("p",{key:e},i.a.createElement(N.a,{className:"btn-contact",to:"/edit?id="+t},t))})),i.a.createElement(N.a,{className:"btn btn-primary btn-lg",to:"/new"},"Add New Credentials"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("button",{className:"btn btn-sm btn-primary topright",onClick:this.props.handleSignOut},"Log out"),i.a.createElement("p",null,"Hint: Click on credentials to view/edit/delete them"))))}}]),n}(a.Component),j=n(58),I=n(581),D=n(578),U=new j.AppConfig,A=new j.UserSession({appConfig:U}),F=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"handleSignIn",value:function(t){t.preventDefault();var e=["store_write","email","publish_data",p.Contact.scope],n=new j.AppConfig(e),a=new j.UserSession({appConfig:n}),i=Object(j.makeAuthRequest)(void 0,void 0,void 0,e,void 0,void 0,{solicitGaiaHubUrl:!0,recommendedGaiaHubUrl:"https://staging-hub.blockstack.xyz"});a.redirectToSignInWithAuthRequest(i)}},{key:"handleSignOut",value:function(t){t.preventDefault(),A.signUserOut(window.location.origin)}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"site-wrapper"},i.a.createElement("div",{className:"site-wrapper-inner"},A.isUserSignedIn()?i.a.createElement(I.a,null,i.a.createElement(D.a,{exact:!0,path:"/",render:function(){return i.a.createElement(x,{handleSignOut:t.handleSignOut})}}),i.a.createElement(D.a,{path:"/edit",component:O}),i.a.createElement(D.a,{path:"/new",render:function(){return i.a.createElement(O,{new:!0})}})):i.a.createElement(m,{userSession:A,handleSignIn:this.handleSignIn})))}},{key:"componentDidMount",value:function(){var t=this;A.isSignInPending()&&A.handlePendingSignIn().then((function(e){window.history.replaceState({},document.title,"/"),t.setState({userData:e})}))}}]),n}(a.Component);n(572),n(573);s.a.render(i.a.createElement(c.a,null,i.a.createElement(F,null)),document.getElementById("root"))}},[[278,1,2]]]);
//# sourceMappingURL=main.aba2af19.chunk.js.map